bankruptcy <- read.csv("[path]/data.csv") #read in the file

mod_bank <- lm(Bankrupt. ~ ., data = bankruptcy) #simple linear regression with all variables
anova(mod_bank)

mod_back <- step(mod_bank, direction = "backward", trace = 0) #step process with backwards deletion 

mod_forward <- step(mod_bank, direction = "forward", trace = 0) #step process with forwards adding 

library(tidyverse)

profitability <- bankruptcy %>% #new dataframe with selected columns based on profitability
  select(Bankrupt., Operating.Gross.Margin, Realized.Sales.Gross.Margin, Pre.tax.net.Interest.Rate, 
  Operating.Profit.Rate, Cash.Flow.to.Equity, Total.income.Total.expense, Revenue.Per.Share..Yuan..., 
  Total.Asset.Turnover, ROA.A..before.interest.and...after.tax, ROA.B..before.interest.and.depreciation.after.tax, 
  ROA.C..before.interest.and.depreciation.before.interest) # 

growth_rates <- bankruptcy %>% 
  select(contains("growth")) #growth rate category dataframe

mod_profit <- glm(Bankrupt. ~., data = profitability, family = binomial)
summary(mod_profit) 
plot(mod_profit, 1)
plot(mod_profit, 2)

mod_back <- step(mod_profit, direction = "backward", trace = 0) #keeps 4 predictors  

mod_forward <- step(mod_profit, direction = "forward", trace = 0) #keeps 6 predictors 

liquidity<- bankruptcy%>%select(Bankrupt.,Current.Ratio,Quick.Ratio,Cash.Flow.to.Total.Assets,Cash.Current.Liability,Working.Capital.to.Total.Assets,Long.term.fund.suitability.ratio..A.,Quick.Assets.Total.Assets)

mod_liquid<-glm(Bankrupt.~.,data=liquidity,family=binomial)
summary(mod_liquid)

plot(mod_liquid,1)
plot(mod_liquid,2)
#a warning popped up that said not plotting observations with leverage one:2500

mod_back<-step(mod_liquid, direction="backward",trace=0)
mod_back

mod_forward<-step(mod_liquid,direction="forward",trace=0)
mod_forward
